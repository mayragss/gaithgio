<div class="page-container">
    <navbar></navbar>
    <p-toast />

    <!-- Desktop Layout - CÓDIGO ORIGINAL MANTIDO -->
    <div class="flex flex-row mt-8 main desktop">
        <div class="w-2 flex-column">
            <!--foreach com o campo tratado-->
            @for (img of images; track $index) {
            <img class="small-image" src="{{img}}" />
            }
        </div>

        <div class="w-4">
            <img class="main-img" src="{{imageMain}}" />
        </div>

        <div class="mb-8 w-5 montserrat flex flex-column">
            <p class="title gaith-color pb-2"> {{product?.name}}</p>
            <p class="price gaith-color"> €{{product?.price}}</p>
            <span class="color gaith-color font-light">Cor: {{attributes['color']}}</span>

            <p class="size gaith-color font-light mt-3">Tamanho</p>
            <div class="mt-0 pt-0 flex flex-row gap-3 mb-5 mt-2">
                @for (item of attributes['size']; track item){
                <div class="size-card gaith-color">{{item}}</div>
                }
            </div>

            <p class="quantity gaith-color">Quantidade</p>
            <div class="quantify-card gaith-color justify-content-between align-items-center flex flex-row">
                <i class="pi pi-plus pl-3 cursor-pointer" (click)="addQuantity()"></i>
                <p class="font-bold">{{quantity}}</p>
                <i class="pi pi-minus pr-3 cursor-pointer" (click)="removeQuantity()"></i>
            </div>

            <button class="mt-3 add-cart w-10 cursor-pointer" (click)="addToCart()">Adicionar ao carrinho</button>

            <div class="pt-8 gaith-color text-regular-size">
                <p class="flex flex-row gap-2">
                    <span>Descrição</span>
                    <i class="text-regular-size pt-1 pi pi-chevron-up"></i>
                </p>
                <p>{{product?.description}}</p>
            </div>
        </div>
    </div>

    <!-- Mobile Layout - NOVA VERSÃO -->
    <div class="mobile-detail-container mobile">
        <div class="mobile-images-container">
            <div class="mobile-thumbnails">
                @for (img of images; track $index) {
                <img class="mobile-thumbnail" [class.active]="imageMain === img" src="{{img}}" (click)="selectImage(img)" />
                }
            </div>
            
            <div class="mobile-main-image">
                <img src="{{imageMain}}" />
            </div>
        </div>

        <div class="mobile-product-info">
            <h1 class="mobile-title">{{product?.name}}</h1>
            <p class="mobile-price">€ {{product?.price}}</p>
            <p class="mobile-color">Cor: {{attributes['color']}}</p>

                <div class="mobile-size-section">
                    <div class="mobile-size-content">
                        <p class="mobile-size-label">Tamanho</p>
                        <div class="mobile-size-options">
                            @for (item of attributes['size']; track item){
                            <div class="mobile-size-card" [class.selected]="selectedSize === item" (click)="selectSize(item)">{{item}}</div>
                            }
                        </div>
                    </div>
                    <div class="mobile-description">
                        <p class="mobile-desc-header" (click)="toggleDescription()">
                            <span>Descrição</span>
                            <i class="pi" [ngClass]="descriptionExpanded ? 'pi-chevron-up' : 'pi-chevron-down'"></i>
                        </p>
                        @if (descriptionExpanded) {
                        <p class="mobile-desc-text">{{product?.description}}</p>
                        }
                    </div>
                </div>

            <div class="mobile-quantity-section">
                <p class="mobile-quantity-label">Quantidade</p>
                <div class="mobile-quantify-card">
                    <i class="pi pi-minus cursor-pointer" (click)="removeQuantity()"></i>
                    <p class="font-bold">{{quantity}}</p>
                    <i class="pi pi-plus cursor-pointer" (click)="addQuantity()"></i>
                </div>
            </div>

                <button class="mobile-add-cart" (click)="addToCart()">Adicionar ao carrinho</button>
        </div>
    </div>

    <footer></footer>
</div>