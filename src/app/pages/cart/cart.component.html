<div class="page-container">
<div class="cart gaith-color center pt-8 montserrat">
  <!-- Desktop Cart -->
  <div class="desktop">
    <div class="flex flex-row justify-content-between">
      <h2 class="font-bold">{{ 'cart.title' | translate }}</h2>
      <a href="/products" class="keep-buying">{{ 'cart.continueShopping' | translate }}</a>
    </div>

    <div class="head flex flex-row pt-4">
      <div class="w-6"style="    justify-items: self-start;"><p>{{ 'cart.product' | translate }}</p></div>
      <div class="w-3 md:pr-4 self-end"><p>{{ 'cart.quantity' | translate }}</p></div>
      <div class="w-3 self-end"><p>{{ 'cart.total' | translate }}</p></div>
    </div>
    <div class="divider mt-3 mb-3"></div>
    @if (items.length > 0) {
    @for (item of items; track item.product.id) {
    <div class="flex flex-row pb-5">
      <div class="w-6 flex flex-row gap-5 item">
        <img [src]="getImageMain(item.product)" alt="{{item.product.name}}" />
        <div class="flex flex-column gap-1 mt-3">
          <p>{{item.product.name}}</p>
          <p>€ {{item.product.price}}</p>
          <p>{{ 'cart.size' | translate }} 
            @if(item.product.attributes != undefined){
            @for (tamanho of getTamanhos(item.product.attributes); track tamanho) {
            <span>{{ tamanho }}</span>
            }}
          </p>
        </div>
      </div>
      <div class="w-3 flex flex-row justify-content-end">
          <!-- <button (click)="remove(item.product.id)">Remover</button> -->
          
        <div class="quantity flex flex-row gap-2 justify-content-between">
          <span class="w-3 cursor-pointer" (click)="updateQuantity(item.product.id, item.quantity + 1)">+</span>
          <span class="w-3 cursor-pointer text" >{{item.quantity}}</span>
          <span class="w-3 cursor-pointer" (click)="updateQuantity(item.product.id, item.quantity - 1)">-</span>
        </div> 
      </div>
      <div class="w-3 flex flex-row price">
        <div class="justify-content-start ml-3 pt-1">
        <i class="pi pi-trash cursor-pointer" (click)="remove(item.product.id)"></i>
        </div>
        <p class="">€
          {{item.product.price}} </p>
      </div>
    </div>
    }
    <div class="divider mt-3 mb-3"></div>

    <div class="price-will-be-payed align-self-end flex flex-column">
      <div class="flex flex-row gap-4">
        <p class="font-bold size-14">{{ 'cart.estimatedTotal' | translate }} </p>
        <p class="font-normal size-14">€{{ totalPrice() }}</p>
      </div>
      <p class="size-6 pb-3">{{ 'cart.taxesNote' | translate }}</p>
      <p-button (click)="finalizarCompra()">{{ 'cart.finalizePurchase' | translate }}</p-button>
      <button (click)="clear()" class="mt-3">{{ 'cart.clearCart' | translate }}</button>
    </div>
    } @else {
    <p>{{ 'cart.empty' | translate }}</p>
    }
  </div>

  <!-- Mobile Cart -->
  <div class="mobile">
    <div class="mobile-cart-header">
      <h2 class="mobile-cart-title">{{ 'cart.title' | translate }}</h2>
      <a href="/products" class="mobile-keep-buying">{{ 'cart.continueShoppingMobile' | translate }}</a>
    </div>

    <div class="mobile-cart-head">
      <p>{{ 'cart.product' | translate }}</p>
      <p>{{ 'cart.quantity' | translate }}</p>
      <p>{{ 'cart.total' | translate }}</p>
    </div>
    <div class="mobile-divider"></div>

    @if (items.length > 0) {
    @for (item of items; track item.product.id) {
    <div class="mobile-cart-item">
      <div class="mobile-item-info">
        <img [src]="getImageMain(item.product)" alt="{{item.product.name}}" />
        <div class="mobile-item-details">
          <p class="mobile-item-name">{{item.product.name}}</p>
          <p class="mobile-item-price">€ {{item.product.price}}</p>
          @if (item.selectedSize) {
          <p class="mobile-item-size">{{ 'cart.size' | translate }} {{getDisplaySize(item.selectedSize)}}</p>
          }
        </div>
      </div>
      <div class="mobile-quantity-section">
        <div class="mobile-quantity">
          <span class="mobile-quantity-btn" (click)="updateQuantity(item.product.id, item.quantity + 1)">+</span>
          <span class="mobile-quantity-text">{{item.quantity}}</span>
          <span class="mobile-quantity-btn" (click)="updateQuantity(item.product.id, item.quantity - 1)">-</span>
        </div>
      </div>
      <div class="mobile-item-total-section">
        <i class="pi pi-trash mobile-trash-icon cursor-pointer" (click)="remove(item.product.id)"></i>
        <p class="mobile-item-total">€{{item.product.price}}</p>
      </div>
    </div>
    }
    <div class="mobile-divider"></div>

    <div class="mobile-total-section">
      <div class="mobile-total-row">
        <p class="mobile-total-label">{{ 'cart.estimatedTotal' | translate }}</p>
        <p class="mobile-total-price">€{{ totalPrice() }}</p>
      </div>
      <p class="mobile-total-note">{{ 'cart.taxesNote' | translate }}</p>
      <p-button class="mobile-checkout-btn" (click)="finalizarCompra()">{{ 'cart.finalizePurchase' | translate }}</p-button>
    </div>

    <button class="mobile-clear-btn" (click)="clear()">{{ 'cart.clearCart' | translate }}</button>
    } @else {
    <p class="mobile-empty-cart">{{ 'cart.empty' | translate }}</p>
    }
  </div>
</div>

@if (showConfirmation) {
  <app-whatsapp-confirmation
    [firstName]="getFirstName()"
    [orderNumber]="createdOrderNumber"
    (confirm)="onConfirmWhatsApp()"
    (cancel)="onCancelWhatsApp()">
  </app-whatsapp-confirmation>
}

<footer></footer>
</div>